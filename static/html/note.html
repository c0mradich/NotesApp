<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Notes</title>
<link rel="stylesheet" href="/static/css/note.css">
</head>
<body>
<header>
    <h1><input type="text" value=""></h1>
</header>
<main>
    <textarea id="noteBody"></textarea>
</main>
<script>
    const titleEl = document.querySelector("header input");
    const bodyEl = document.querySelector("#noteBody");

    const title_info = sessionStorage.getItem("msg_title");
    const body_info = sessionStorage.getItem("msg_body");

    if (title_info) titleEl.value = title_info;
    if (body_info) bodyEl.value = body_info;

    if (!title_info || !body_info) {
        const msg_id = sessionStorage.getItem("msg_id");
        if (msg_id) {
            fetch(`/get-note/${msg_id}`)
                .then(res => res.json())
                .then(data => {
                    titleEl.value = data.title;   // исправлено
                    bodyEl.value = data.body;     // исправлено
                })
                .catch(err => console.error("Ошибка загрузки заметки с сервера:", err));
        }
    }
</script>
</body>
</html>
